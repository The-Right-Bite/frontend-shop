import{j as t,a as b}from"./index-Xu99HZNl.js";import{r as N,u as g}from"./router-txoNkVqA.js";import{g as w}from"./getProductImage-Cf9UR-Sm.js";import{B as y}from"./Breadcrumbs-CZEJ6zOL.js";import"./vendor-DoC2WAmd.js";const T="_section_e4v57_1",I="_container_e4v57_9",k="_innerWrapper_e4v57_21",f="_title_e4v57_31",S="_tableTitleFirst_e4v57_45",q="_table_e4v57_45",B="_header_e4v57_83",E="_tableTitle_e4v57_45",W="_itemInner_e4v57_117",D="_banner_e4v57_135",a={section:T,container:I,innerWrapper:k,title:f,tableTitleFirst:S,table:q,header:B,tableTitle:E,itemInner:W,banner:D},F="_row_wn3s7_17",A="_product_wn3s7_33",P="_imagePlaceholder_wn3s7_43",R="_img_wn3s7_53",L="_productInner_wn3s7_67",U="_id_wn3s7_83",$="_name_wn3s7_93",M="_price_wn3s7_113",O="_quantity_wn3s7_115",J="_subtotal_wn3s7_117",V="_quantityNumber_wn3s7_169",Q="_quantityBtn_wn3s7_179",z="_remove_wn3s7_207",o={row:F,product:A,imagePlaceholder:P,img:R,productInner:L,id:U,name:$,price:M,quantity:O,subtotal:J,quantityNumber:V,quantityBtn:Q,remove:z};function H({item:n,onQuantityChange:r,onRemove:i}){const{price:j,quantity:c,weight:d}=n,m=w(n.image),x=(j*c).toFixed(2),u=()=>{c>1&&r(c-1)},p=()=>{r(c+1)};return console.log("CartItem item:",n),t.jsxs("div",{className:o.row,children:[t.jsxs("div",{className:o.product,children:[t.jsx("div",{className:o.imagePlaceholder,children:t.jsx("img",{src:m||"/placeholder.png",alt:n.name,className:o.img})}),t.jsxs("div",{className:o.productInner,children:[t.jsx("div",{className:o.id,children:n.id}),t.jsxs("div",{className:o.name,children:[n.name," ",n.size]}),d&&t.jsx("div",{className:o.weight,children:d})]})]}),t.jsxs("div",{className:o.price,children:["€ ",n.price.toFixed(2)]}),t.jsxs("div",{className:o.quantity,children:[t.jsx("button",{onClick:u,className:o.quantityBtn,children:"-"}),t.jsx("span",{className:o.quantityNumber,children:n.quantity}),t.jsx("button",{onClick:p,className:o.quantityBtn,children:"+"})]}),t.jsxs("div",{className:o.subtotal,children:["€ ",x]}),t.jsx("button",{className:o.remove,onClick:i,children:t.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"M19.5 5.5L18.88 15.525C18.722 18.086 18.643 19.367 18 20.288C17.6826 20.7432 17.2739 21.1273 16.8 21.416C15.843 22 14.56 22 11.994 22C9.424 22 8.139 22 7.18 21.415C6.70589 21.1257 6.29721 20.7409 5.98 20.285C5.338 19.363 5.26 18.08 5.106 15.515L4.5 5.5M3 5.5H21M16.056 5.5L15.373 4.092C14.92 3.156 14.693 2.689 14.302 2.397C14.2151 2.33232 14.1232 2.27479 14.027 2.225C13.594 2 13.074 2 12.035 2C10.969 2 10.436 2 9.995 2.234C9.89752 2.28621 9.80453 2.34642 9.717 2.414C9.322 2.717 9.101 3.202 8.659 4.171L8.053 5.5M9.5 16.5V10.5M14.5 16.5V10.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]})}const G="_cartTotalWrapper_1ktrj_1",K="_cartTotalContainer_1ktrj_9",X="_cartTotalTitle_1ktrj_25",Y="_cartTotalDetails_1ktrj_45",Z="_row_1ktrj_53",tt="_totalRow_1ktrj_71",et="_line_1ktrj_81",nt="_totalAmount_1ktrj_93",st="_couponSection_1ktrj_101",ot="_couponInputWrapper_1ktrj_111",at="_couponInput_1ktrj_111",ct="_couponButton_1ktrj_163",rt="_couponSuccess_1ktrj_195",lt="_couponError_1ktrj_207",it="_checkoutButton_1ktrj_219",e={cartTotalWrapper:G,cartTotalContainer:K,cartTotalTitle:X,cartTotalDetails:Y,row:Z,totalRow:tt,line:et,totalAmount:nt,couponSection:st,couponInputWrapper:ot,couponInput:at,couponButton:ct,couponSuccess:rt,couponError:lt,checkoutButton:it};function dt(){const{items:n,subtotal:r,discount:i,total:j,appliedCoupon:c,applyCoupon:d}=b(),[m,x]=N.useState(""),[u,p]=N.useState(""),C=g(),s=()=>{d(m)?(p(""),x("")):p("Invalid coupon code")},h=()=>{if(n.length===0)return;const v={id:`ORDER-${Date.now()}`,date:new Date().toISOString(),items:n.map(l=>({...l,subtotal:l.price*l.quantity})),subtotal:r,discount:i,total:j,appliedCoupon:c};localStorage.setItem("order",JSON.stringify(v)),C("/checkout")};return t.jsxs("div",{className:e.cartTotalContainer,children:[t.jsx("h4",{className:e.cartTotalTitle,children:"Cart Total"}),t.jsxs("div",{className:e.cartTotalWrapper,children:[t.jsxs("div",{className:e.cartTotalDetails,children:[t.jsxs("div",{className:e.row,children:[t.jsx("span",{children:"Subtotal"}),t.jsxs("span",{children:["€ ",r.toFixed(2)]})]}),t.jsxs("div",{className:e.row,children:[t.jsx("span",{children:"Shipping"}),t.jsx("span",{children:"Free"})]}),c&&i>0&&t.jsxs("div",{className:e.row,children:[t.jsxs("span",{children:["Discount (",c.code,")"]}),t.jsxs("span",{className:e.discount,children:["-€",i.toFixed(2)]})]}),t.jsxs("div",{className:`${e.row} ${e.totalRow}`,children:[t.jsx("span",{children:"Total"}),t.jsxs("span",{className:e.totalAmount,children:["€ ",j.toFixed(2)]})]})]}),t.jsxs("div",{className:e.couponSection,children:[t.jsxs("div",{className:e.couponInputWrapper,children:[t.jsx("input",{type:"text",placeholder:"Enter your Code",className:e.couponInput,value:m,onChange:_=>{x(_.target.value),p("")}}),t.jsx("button",{className:e.couponButton,onClick:s,disabled:!m.trim(),children:"Apply Coupon"})]}),u&&t.jsx("div",{className:e.couponError,children:u}),c&&t.jsxs("div",{className:e.couponSuccess,children:['Coupon "',c.code,'" applied successfully!']}),t.jsx("div",{className:e.line}),t.jsx("button",{className:e.checkoutButton,onClick:h,children:"Proceed to checkout"})]})]})]})}const ut="/online-store-frontend/assets/banner_cart-b22TboJV.webp";function xt(){const n="https://right-bite-store.onrender.com",{items:r,addItem:i,updateQuantity:j,removeItem:c}=b();N.useEffect(()=>{const s=localStorage.getItem("cart");if(s&&JSON.parse(s).length>0)return;(async()=>{try{const _=await fetch(`${n}/api/v1/cart`);if(!_.ok)throw new Error("Failed to load cart");(await _.json()).forEach(l=>i({id:l.id,name:l.productName,price:l.price,quantity:l.quantity,image:l.imageUrl||""}))}catch(_){console.error("Cart fetch error:",_)}})()},[r,i,n]);const[d,m]=N.useState(null),x=s=>s.toUpperCase()==="DISCOUNT10"?(m({code:"DISCOUNT10",discount:.1,type:"percentage"}),!0):!1,u=r.reduce((s,h)=>s+h.price*h.quantity,0),p=d?u*d.discount:0,C=u-p;return t.jsxs("section",{className:a.section,children:[t.jsx("div",{children:t.jsx("img",{src:ut,alt:"Sale of the month - 50% off",className:a.banner})}),t.jsxs("div",{className:a.container,children:[t.jsx(y,{items:[{title:"Catalog",path:"/catalog"},{title:"Shopping Cart"}],hideCurrent:!0}),t.jsx("h1",{className:a.title,children:"My Shopping Cart"}),t.jsxs("div",{className:a.innerWrapper,children:[t.jsxs("div",{className:a.table,children:[t.jsxs("div",{className:a.header,children:[t.jsx("span",{className:a.tableTitleFirst,children:"Product"}),t.jsx("span",{className:a.tableTitle,children:"Price"}),t.jsx("span",{className:a.tableTitle,children:"Quantity"}),t.jsx("span",{className:a.tableTitle,children:"Subtotal"}),t.jsx("span",{className:a.tableTitle})]}),t.jsx("div",{className:a.itemInner,children:r.map(s=>t.jsx(H,{item:{...s,subtotal:s.price*s.quantity},onQuantityChange:h=>j(s.id,h),onRemove:()=>c(s.id)},s.id))})]}),t.jsx(dt,{subtotal:u,total:C,discount:p,appliedCoupon:d,onApplyCoupon:x})]})]})]})}export{xt as default};
